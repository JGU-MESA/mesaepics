record(stringout, "$(P)$(R)debug"){
    field(DTYP, "stream")
    field(OUT, "@abacus_laserdiode.proto debug $(PORT)")
}


 record(bi, "$(P)$(R)tled_get"){
     field(DESC, "Read on/off status of laser")
     field(DTYP, "stream")
     field(INP, "@abacus_laserdiode.proto tled_get $(PORT)")
     field(ZNAM, "OFF")
     field(ONAM, "ON")
     field(SCAN, "1 second")
 }

 record(bo, "$(P)$(R)tled_set"){
     field(DESC, "Set laser on/off")
     field(DTYP, "stream")
     field(OUT, "@abacus_laserdiode.proto tled_set $(PORT)")
     field(ZNAM, "OFF")
     field(ONAM, "ON")
     field(FLNK, "$(P)$(R)on_get.PROC") 
 }

# record(bi, "$(P)$(R)on_get"){
    # field(DESC, "Read on/off status of laser")
    # field(DTYP, "stream")
    # field(INP, "@abacus_laserdiode.proto on_get $(PORT)")
    # field(ZNAM, "OFF")
    # field(ONAM, "ON")
    # field(SCAN, "1 second")
# }

# record(bo, "$(P)$(R)on_set"){
    # field(DESC, "Set laser on/off")
    # field(DTYP, "stream")
    # field(OUT, "@abacus_laserdiode.proto on_set $(PORT)")
    # field(ZNAM, "OFF")
    # field(ONAM, "ON")
    # field(FLNK, "$(P)$(R)on_get.PROC") 
# }


#===== Pulse Length =====
record(ai, "$(P)$(R)pl_get"){
    field(DESC, "Read pulse length")
    field(DTYP, "stream")
    field(INP, "@abacus_laserdiode.proto pl_get $(PORT)")
    field(EGU, "us")
    field(HOPR, "1000000")
    field(LOPR, "100")
    field(SCAN, "1 second")
}

record(ao, "$(P)$(R)pl_set"){
    field(DESC, "Set pulse length")
    field(DTYP, "stream")
    field(OUT, "@abacus_laserdiode.proto pl_set $(PORT)")
    field(DRVH, "8388478")
    field(DRVL, "25")
    field(HOPR, "1000000")
    field(LOPR, "100")
    field(PREC, "0")
    field(EGU, "us")    
    field(FLNK, "$(P)$(R)pl_get.PROC")
}

#===== Amplitude =====
record(ai, "$(P)$(R)amp_get"){
    field(DESC, "Read amplitude")
    field(DTYP, "stream")
    field(INP, "@abacus_laserdiode.proto amp_get $(PORT)")
    field(HOPR, "4095")
    field(LOPR, "0")
    field(PREC, "0")
    field(EGU, "")
    field(HOPR, "4095")
    field(LOPR, "0")
    field(HIGH, "4095") #=1W laser power
    field(HIHI, "4095") #=3W laser power
    field(HHSV, "MAJOR") 
    field(HHSV, "MINOR")
    field(SCAN, "1 second")
}

record(calc, "$(P)$(R)setamp_get"){
    field(DESC, "Read the set amplitude at emission")
    field(INPA, "$(P)$(R)amp_get")
    field(SCAN, "Passive")
    field(HOPR, "4095")
    field(LOPR, "0")
    field(PREC, "0")
    field(EGU, "")
    field(HOPR, "4095")
    field(LOPR, "0")
    field(HIGH, "4095") #=1W laser power
    field(HIHI, "4095") #=3W laser power
    field(HHSV, "MAJOR") 
    field(HHSV, "MINOR")
    field(CALC, "A")
}

record(ao, "$(P)$(R)amp_set"){
    field(DESC, "Set amplitude")
    field(DTYP, "stream")
    field(OUT, "@abacus_laserdiode.proto amp_set $(PORT)")
    field(DRVH, "4095")   #current Maximum set to 1mW
    field(DRVL, "1")
    field(HOPR, "4095")
    field(LOPR, "0")
    field(PREC, "0")
    field(EGU, "")    
}

#===== Cycle time = time span between two shots =====
record(ai, "$(P)$(R)dt_get"){
    field(DESC, "Read time betw. two shots")
    field(DTYP, "stream")
    field(INP, "@abacus_laserdiode.proto dt_get $(PORT)")
    field(EGU, "us")
    field(HOPR, "500000")
    field(LOPR, "100")
    field(SCAN, "1 second")
}

record(ao, "$(P)$(R)dt_set"){
    field(DESC, "Set time betw. two shots")
    field(DTYP, "stream")
    field(OUT, "@abacus_laserdiode.proto dt_set $(PORT)")
    field(DRVH, "500000")
    field(DRVL, "100")
    field(HOPR, "500000")
    field(LOPR, "100")
    field(PREC, "0")
    field(EGU, "us")    
    field(FLNK, "$(P)$(R)dt_get.PROC")
}

##===== Number of shots =====
#record(ai, "$(P)$(R)nos_get"){
#    field(DESC, "Read number of shots")
#    field(DTYP, "stream")
#    field(INP, "@abacus_laserdiode.proto nos_get $(PORT)")
#    field(EGU, "")
#	field(HOPR, "100000000")
#    field(LOPR, "2")
#    field(SCAN, "1 second")
#}
#
#record(ao, "$(P)$(R)nos_set"){
#    field(DESC, "Set pulse length")
#    field(DTYP, "stream")
#    field(OUT, "@abacus_laserdiode.proto nos_set $(PORT)")
#    field(DRVH, "100000000")
#    field(DRVL, "2")
#    field(HOPR, "100000000")
#    field(LOPR, "2")
#    field(PREC, "0")
#    field(EGU, "")    
#}

#===== DC mode =====
record(bo, "$(P)$(R)dc_set"){
    field(DESC, "Set dc beam on or off")
    field(DTYP, "stream")
    field(OUT, "@abacus_laserdiode.proto dc_set $(PORT)")
    field(ZNAM, "OFF")
    field(ONAM, "ON")
    field(FLNK, "$(P)$(R)setamp_get.PROC") 
}

record(bi, "$(P)$(R)dc_get"){
    field(DESC, "Read dc on/off")
    field(DTYP, "stream")
    field(INP, "@abacus_laserdiode.proto dc_get $(PORT)")
    field(ZNAM, "OFF")
    field(ONAM, "ON")
    field(SCAN, "1 second")
}

##===== Shot =====
#record(bo, "$(P)$(R)sh_set"){
#    field(DESC, "Execute one shot")
#    field(DTYP, "stream")
#    field(OUT, "@abacus_laserdiode.proto sh_set $(PORT)")
#    field(FLNK, "$(P)$(R)setamp_get.PROC") 
#}

#===== Multiple Shot =====
record(bo, "$(P)$(R)mu_set"){
    field(DESC, "Execute multiple shot")
    field(DTYP, "stream")
    field(OUT, "@abacus_laserdiode.proto mu_set $(PORT)")
	field(ZNAM, "0")
	field(ONAM, "1")
    field(FLNK, "$(P)$(R)setamp_get.PROC")
}

record(bi, "$(P)$(R)mu_get"){
    field(DESC, "Read dc on/off")
    field(DTYP, "stream")
    field(INP, "@abacus_laserdiode.proto mu_get $(PORT)")
    field(ZNAM, "OFF")
    field(ONAM, "ON")
    field(SCAN, ".5 second")
}
