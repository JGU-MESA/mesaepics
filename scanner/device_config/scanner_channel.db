#macros P,R und CH

record(ai, "$(P)$(R)i_get")
{
    field(DESC,"Get signal at analog input $(CH)")
    field(DTYP,"stream")
    field(INP,"@scanner.proto getAI($(CH)) $(PORT)")
    field(SCAN,".1 second")
    field(PREC,"0")
    field(EGU, "bit")
    field(HOPR, "65535")
    field(LOPR, "0")
    #field(DISP, "1")
}

record(ao, "$(P)$(R)aver_set")
{
    field(DESC,"Set averaging of pmt input 2^(value)")
    field(DTYP,"stream")
    field(OUT,"@scanner.proto setAVER($(CH)) $(PORT)")
}

record(ai, "$(P)$(R)pmg_get")
{
    field(DESC,"Get gain of photomultiplier input")
    field(DTYP,"stream")
    field(INP,"@scanner.proto getPMGain $(PORT)")
    field(SCAN, "1 second")
}

record(ao, "$(P)$(R)pmg_set")
{
    field(DESC,"Set gain of photomultiplier input")
    field(PREC, "0")
    field(DRVH, "3")
    field(DRVL, "0")
    field(FLNK, "$(P)$(R)pmg_send.PROC")
}

record(calcout, "$(P)$(R)pmg_send")
{
    field(DESC,"Set gain of photomultiplier input")
    field(DTYP,"stream")
    field(OUT,"@scanner.proto setPMGain $(PORT)")
    field(INPA, "$(P)$(R)pmg_get")
    field(INPB, "$(P)$(R)pmg_set")
    field(INPC, "$(CH)")
    field(CALC, "C = 1 ? (A & 12) | B : (A & 3) | (B << 2)")
    field(FLNK, "$(P)$(R)pmg_get")
}
